function e(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach(function(n){if("default"!==n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})}}),t.default=e,t}function t(e){this.wrapped=e}function n(e){var n,r;function o(n,r){try{var c=e[n](r),a=c.value,u=a instanceof t;Promise.resolve(u?a.wrapped:a).then(function(e){u?o("return"===n?"return":"next",e):i(c.done?"return":"normal",e)},function(e){o("throw",e)})}catch(e){i("throw",e)}}function i(e,t){switch(e){case"return":n.resolve({value:t,done:!0});break;case"throw":n.reject(t);break;default:n.resolve({value:t,done:!1})}(n=n.next)?o(n.key,n.arg):r=null}this._invoke=function(e,t){return new Promise(function(i,c){var a={key:e,arg:t,resolve:i,reject:c,next:null};r?r=r.next=a:(n=r=a,o(e,t))})},"function"!=typeof e.return&&(this.return=void 0)}function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}function i(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,a(e,t)}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function s(e,t,n){return(s=u()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&a(o,n.prototype),o}).apply(null,arguments)}function l(e){var t="function"==typeof Map?new Map:void 0;return(l=function(e){if(null===e||-1===Function.toString.call(e).indexOf("[native code]"))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return s(e,arguments,c(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),a(n,e)})(e)}function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function p(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}n.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},n.prototype.next=function(e){return this._invoke("next",e)},n.prototype.throw=function(e){return this._invoke("throw",e)},n.prototype.return=function(e){return this._invoke("return",e)};var d=Symbol(),v=Symbol(),m=Symbol(),y=Symbol(),b=Symbol(),g=Symbol(),w=Symbol(),O=Symbol(),j=Symbol(),S=Symbol(),E=Symbol(),P=Symbol(),$=function(e,t){console.log("TERROR-801::Attempted to use Object.defineProperty on "+e+", please use the default setter ('"+e+"."+t+" = ') instead")},k=function(e){console.log("TERROR-821::"+e+" is not a valid callback!")},x=function(){var e=.01*window.innerHeight,t=.01*window.innerWidth;document.body.style.setProperty("--mh",e+"px"),document.body.style.setProperty("--mw",t+"px")};function R(e,t){var n=e.replaceAll(/[\s\n]+/g," ").replaceAll(/(;|{|})(\S)/g,"$1 $2").replaceAll(/(;|{|})(\s)/g,"$1\n").replaceAll(/("([^";]*)")/g,"'$2'").replaceAll(/(")/g,"\\$1").replaceAll(/(\d+)( *v)(h|w)/gm," calc($1 * var(--m$3) ) ").replaceAll(/^[ ]*([@].*[^ ":])[ ]*({)$/gm,'"$1": $2').replaceAll(/^[ ]*([&].*[^ ":])[ ]*({)$/gm,'"$1": $2').replaceAll(/^[ ]*([^&}@]?.*[^ ":])[ ]*({)$/gm,'"$1": $2').replaceAll(/^[ ]*([-=a-zA-Z ]+):[ ]*([^;]+);[ ]*$/gm,'"$1": "$2",').replaceAll(/^[ ]*(})[ ]*$/gm,"$1,").replaceAll(/,[ ]*\n[ ]*\}/g,"\n}").replaceAll(/,[ ]*$/g,"");console.log(n);var r=JSON.parse("{"+n+"}");function o(e,t,n){Object.entries(e).forEach(function(r){var i=r[0],c=r[1];if("object"==typeof c&&i.startsWith("&")){var a=i.replaceAll(/&/g,n);t[a]=c,Object.entries(c).forEach(function(e){"object"==typeof e[1]&&e[0].startsWith("&")&&o(t[n+a],t,n+a)}),delete e[i]}})}return Object.entries(r).forEach(function(e){var n,i=e[0],c=e[1];"object"==typeof c&&(t?(r[n=t+" > "+i]=c,delete r[i]):n=i,o(r[n],r,n))}),r}function A(e,t){if(!e[t])if(7===e[j].type){var n=e[j].cssRules.length;e[j].appendRule(t+" {}"),e[t]=e[j].cssRules[n]}else{var r=e[j].cssRules.length;e[j].insertRule(t+" {}",r),e[t]=e[j].cssRules[r]}}function L(e,t){void 0===t&&(t=!1);var n=L.$||(L.$={enumerable:t,writable:!1,configurable:!1,value:e});return n.value!==e&&(n.value=e),n}x(),window.onresize=x;var M=function(){function e(e){return this[v]={},this[d]=e,Object.seal(this),this}var t=e.prototype;return t[m]=function(){var e=this;Object.getOwnPropertySymbols(this[v]).forEach(function(t){return e[v][t](e[d])})},t[y]=function(e){this[v][e.id]=e},t[b]=function(e){delete this[v][e.id]},t.valueOf=function(){return this[d]},t.toString=function(){return this[d]},t.toLocaleString=function(){return this[d]},e}(),T=function(){function e(e){var t=this;this.value=e[d];var n=function(e){return!!e.id||(k(e),!1)};return Object.defineProperty(this,"addObserver",L(function(r){return n(r)&&e[y](r),t},!0)),Object.defineProperty(this,"deleteObserver",L(function(r){return n(r)&&e[b](r),t},!0)),this}var t=e.prototype;return t.valueOf=function(){return this.value},t.toLocaleString=function(){return this.value},t.toString=function(){return this.value},e}(),_={callbacks:{defineProperty:function(e,t){return $("this.callbacks",t),!0},get:function(e,t){return e[t]},set:function(e,t,n){return n.id=Symbol(),Object.defineProperty(e,t,L(n,!0)),!0}},observables:{defineProperty:function(e,t){return $("this.observables",t),!0},get:function(e,t){return new T(e[t])},set:function(e,t,n){return e[t]?e[t][d]=n:e[t]=new M(n),e[t][m](),!0}},components:{defineProperty:function(){k("componentsRegistry")},get:function(e,t){return e[t]},set:function(){return!0}},style:{get:function(e,t){return A(e,t),function(n,r){e[t].style.setProperty(n,r)}},set:function(e,t,n){var r=n[0],o=n[1];return A(e,t),e[t].style.setProperty(r,o),!0}}},N=regeneratorRuntime.mark(H);function H(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=0;case 1:return t.next=3,"GID"+e+Date.now()+e;case 3:e+=1;case 4:t.next=1;break;case 6:case"end":return t.stop()}},N)}var C=H(),I={val:"",get:function(){return this.val=C.next().value,this.val}},q=new(function(){function e(){this[O]=document.createElement("style"),this[O].id="destyle",document.head.appendChild(this[O]);var e=Object.create(null);e[j]=this[O].sheet,console.log(e),this[S]=new Proxy(e,_.style),this[E]={rules:Object.create(null),new:function(t){var n=e[j].cssRules.length;e[j].insertRule(t+" {}",n);var r=Object.create(null);return r[j]=e[j].cssRules[n],this.rules[t]=new Proxy(r,_.style),this.rules[t]}}}return e.prototype.setStyle=function(e){var t=this,n=function(e,n){t[E].new(e),Object.entries(n).forEach(function(n){var r=n[0];Object.entries(n[1]).forEach(function(n){var o=n[1];"object"!=typeof o?t[E].rules[e][r](n[0],o):function(e){console.log("TERROR-903::invalid style, "+e+" is not a string value!")}(o)})})};Object.entries(e).forEach(function(e){var r=e[0],o=e[1];console.log("errHere "+r+"::"+o),r.startsWith("@")?(console.log("errHere"+r+"::"+o),n(r,o)):function(e,r){Object.entries(r).forEach(function(o){var i=o[1];"object"!=typeof i?t[S][e](o[0],i):n(e,r)})}(r,o)})},e}());q.setStyle({"de-group":{display:"flex","flex-direction":"row","align-items":"center","justify-content":"space-evenly","align-content":"space-evenly"},"de-group[col]":{"flex-direction":"column","justify-content":"stretch"},"de-group[stretch]":{"align-items":"stretch"},"de-group[wrap]":{"flex-wrap":"wrap","justify-content":"space-evenly"}});var D=function(){function e(e,t){var n=this;this[g]=Object.create(null),this[w]=Object.create(null),this.callbacks=new Proxy(this[g],_.callbacks),this.observables=new Proxy(this[w],_.observables),this.properties={components:{}};var r=0;t.forEach(function(o,i){var c,a;switch(typeof o){case"string":c=[].concat(e[i].matchAll(/<$/g)),a=[].concat(e[i+1].matchAll(/^>/g)),c[0]&&a[0]?(I.get(),n.properties[o]='gid value="'+I.val+'"></gid',n.properties.components[o]='gid[value="'+I.val+'"]'):n.properties[o]="";break;case"function":n.properties["cProp"+r]=o();break;case"object":n.properties["cProp"+r]=o.$;break;default:n.properties["cProp"+r]=o,t[i]="cProp"+r,r+=1}}),console.log(this.properties),this.elements=[];var o=function(e){var t=e.join(""),n=[],r=[].concat(t.matchAll(/(<[\w-]+[ ]*(?:[\w-]+(?:=".+")?)*[ ]+)(?:@)([\w$][\w$]*)(?:@)(?=[^>]*>)/g)),o=[];return console.log(r),r.forEach(function(e){o.push(e[2])}),e.forEach(function(e){return n.push(e.replaceAll(/(<[\w-]+[ ]*(?:[\w-]+(?:=".+")?)*[ ]+)(?:@)([\w$][\w$]*)(?:@)(?=[^>]*(?:>|$))/g,'$1de-name="$2" '))}),{names:o,lines:n}}(e);return o.names.forEach(function(e){return n.elements.push(e)}),this[P]=function(e,t){return function(n){var r=e[0];return console.log(t),t.forEach(function(t,o){r+=n[t]?n[t]:"",r+=e[o+1]}),(new DOMParser).parseFromString(r,"text/html").body.firstChild}}(o.lines,t),console.log(o),this}var t=e.prototype;return t.setStyle=function(e){this.style=R(e,"de-"+this.Name),q.setStyle(this.style)},t.setName=function(e){return this.Name=e,customElements.define("de-"+this.Name,function(e){function t(){var t,n;return n=e.call(this)||this,q.setStyle(((t={})[n.tagName]={display:"contents"},t)),n}return i(t,e),t}(l(HTMLElement))),this.element=document.createElement("de-"+this.Name),this},t.setOnLoad=function(e){return this.onLoad=e,this},o(e,[{key:"name",get:function(){return this.Name}}]),e}();function J(e){var t=new D(e.lines,e.keys).setName(e.name);return e.onLoad&&t.setOnLoad(e.onLoad),e.style&&t.setStyle(e.style),e.callbacks&&Object.entries(e.callbacks).forEach(function(e){t.callbacks[e[0]]=e[1]}),e.observables&&Object.entries(e.observables).forEach(function(e){t.observables[e[0]]=e[1]}),function(){function e(e){var n=this;this.properties={};var r={};Object.assign(this.properties,t.properties),e&&e.components?(Object.assign(r,e.components),delete e.components):Object.assign(r,t.properties.components),e&&Object.entries(e).forEach(function(e){var t=e[1];t&&(n.properties[e[0]]=t)}),this.element=document.createElement("de-"+t.name),this.element.appendChild(t[P](this.properties)),this.elements={components:{}},Object.entries(r).forEach(function(e){var t=e[0],r=e[1],o=n.element.querySelector(n.properties.components[t]);o&&(r&&"object"==typeof r&&(o.insertAdjacentElement("afterend",r.element),n.elements.components[t]=r,r.onLoad&&r.onLoad()),o.remove())}),t.elements.forEach(function(e){console.log('[de-name="'+e+'"]'),n.elements[e]=n.element.querySelector('[de-name="'+e+'"]')}),this.callbacks=new Proxy(Object.create(null),_.callbacks),Object.entries(t[g]).forEach(function(e){var t=e[0],r=e[1].bind(n);n.callbacks[t]=r}),this.observables=new Proxy(Object.create(null),_.observables),Object.entries(t[w]).forEach(function(e){n.observables[e[0]]=e[1]});var o=t.onLoad;return o&&(this.onLoad=o.bind(this)),document.body.addEventListener("attached",function e(){n.element.isConnected&&n.onLoad&&(document.body.removeEventListener("attached",e),n.onLoad())}),this}var n=e.prototype;return n.toString=function(){return this.element.outerHTML},n.toLocaleString=function(){return this.element.outerHTML},n.valueOf=function(){return this.element},o(e,[{key:"name",get:function(){return t.name}}]),e}()}var W=Object.create(null),F=new Proxy(W,_.components);window.history.replaceState('{ "de$": [ "'+location.href+'" ] }',"");var z={get:function(e,t){var n=JSON.parse(window.history.state);return console.log(n),console.log(e[t]),n.de$[e[t]]},set:function(e,t,n){if("function"==typeof n||"symbol"==typeof n)return console.log("TERROR-903::invalid value, can't store functions and symbols in state!"),!1;var r=JSON.parse(window.history.state);return"url"===t?r.de$[0]=n:e[t]?r.de$[e[t]]=n:(e[t]=r.de$.length,r.de$.push(n)),window.history.pushState(JSON.stringify(r),"",r.de$[0]),!0}},B=Object.create(null);B.url=0;var G,U,Z=new Proxy(B,z),K=Object.create(null),Q=new Proxy(K,_.components),V={elements:{page:document.querySelector("de-compose")}},X={set head(e){V.element.insertAdjacentElement("beforebegin",(G=e).element),U=G.callbacks.onLoad},get head(){return G},pages:Q,newPage:function(e){var t=arguments;return function(n){var r=e.flat();r.unshift('<de-compose @page@ de-page="'+n.name+'">'+r.shift()),r.push(r.pop()+"</de-compose>"),n.lines=r,n.keys=[].slice.call(t,1);var o=J(n);K[n.name]={load:function(e){document.title=n.title;var t=new o(e);V.elements.page.insertAdjacentElement("afterend",t.elements.page),V.elements.page.remove(),V=t}}}},navigate:function e(t){Q[t].load(Z.props),Z.url=new URL(location.protocol+location.host+location.pathname+"/#/"+t),U&&U(),window.onpopstate=function(){console.log(location.hash),location.hash!=="#"+t&&e(location.hash)}}},Y=function(e){function t(){var t;t=e.call(this)||this,console.log(t.attributes);var n=t.querySelector("de-else");if(t.attributes.true){for(n.remove();t.childElementCount>0;){var r=t.children[0];r.remove(),t.insertAdjacentElement("beforebegin",r)}return t.remove(),f(t)||f(t)}for(;n.childElementCount>0;){var o=n.children[0];o.remove(),t.insertAdjacentElement("beforebegin",o)}return t.remove(),f(t)||f(t)}return i(t,e),t}(l(HTMLElement));function ee(e,t,n){if(!e.s){if(n instanceof te){if(!n.s)return void(n.o=ee.bind(null,e,t));1&t&&(t=n.s),n=n.v}if(n&&n.then)return void n.then(ee.bind(null,e,t),ee.bind(null,e,2));e.s=t,e.v=n;var r=e.o;r&&r(e)}}customElements.define("de-else",function(e){function t(){return e.apply(this,arguments)||this}return i(t,e),t}(l(HTMLElement))),customElements.define("de-group",function(e){function t(){return e.apply(this,arguments)||this}return i(t,e),t}(l(HTMLElement))),customElements.define("de-if",Y);var te=function(){function e(){}return e.prototype.then=function(t,n){var r=new e,o=this.s;if(o){var i=1&o?t:n;if(i){try{ee(r,1,i(this.v))}catch(e){ee(r,2,e)}return r}return this}return this.o=function(e){try{var o=e.v;1&e.s?ee(r,1,t?t(o):o):n?ee(r,1,n(o)):ee(r,2,o)}catch(e){ee(r,2,e)}},r},e}();function ne(e){return e instanceof te&&1&e.s}function re(e,t){try{var n=e()}catch(e){return t(!0,e)}return n&&n.then?n.then(t.bind(null,!1),t.bind(null,!0)):t(!1,n)}var oe={components:F,compose:function(e){var t=arguments;return function(n){return n.lines=e,n.keys=[].slice.call(t,1),W[n.name]=J(n),F}},router:X,page:V,setGlobalStyle:function(e){var t=R(e);q.setStyle(t)},globs:{},deps:[],load:function(t){try{return Promise.resolve(Promise.resolve().then(function(){return e(require(t))})).then(function(e){return e.default.bind(oe)})}catch(t){return Promise.reject(t)}},loader:function(e){try{var t,r,o,i,c=(s=regeneratorRuntime.mark(function e(t){var n,r,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=p(t);case 1:if((r=n()).done){e.next=7;break}return o=r.value,e.next=5,oe.load(o);case 5:e.next=1;break;case 7:case"end":return e.stop()}},e)}),l=function(){return new n(s.apply(this,arguments))},function(e){return l.apply(this,arguments)})(e),a=!0,u=!1;return Promise.resolve(re(function(){return function(e,n){try{var i=function(){t=function(e){var t;if("undefined"!=typeof Symbol&&(Symbol.asyncIterator&&(t=e[Symbol.asyncIterator]),null==t&&Symbol.iterator&&(t=e[Symbol.iterator])),null==t&&(t=e["@@asyncIterator"]),null==t&&(t=e["@@iterator"]),null==t)throw new TypeError("Object is not async iterable");return t.call(e)}(c);var e=function(e,t,n){for(var r;;){var o=e();if(ne(o)&&(o=o.v),!o)return i;if(o.then){r=0;break}var i=n();if(i&&i.then){if(!ne(i)){r=1;break}i=i.s}if(t){var c=t();if(c&&c.then&&!ne(c)){r=2;break}}}var a=new te,u=ee.bind(null,a,2);return(0===r?o.then(l):1===r?i.then(s):c.then(f)).then(void 0,u),a;function s(r){i=r;do{if(t&&(c=t())&&c.then&&!ne(c))return void c.then(f).then(void 0,u);if(!(o=e())||ne(o)&&!o.v)return void ee(a,1,i);if(o.then)return void o.then(l).then(void 0,u);ne(i=n())&&(i=i.v)}while(!i||!i.then);i.then(s).then(void 0,u)}function l(e){e?(i=n())&&i.then?i.then(s).then(void 0,u):s(i):ee(a,1,i)}function f(){(o=e())?o.then?o.then(l).then(void 0,u):l(o):ee(a,1,i)}}(function(){return!!Promise.resolve(t.next()).then(function(e){return a=r.done,r=e,Promise.resolve(r.value).then(function(e){return o=e,!a})})},function(){return!!(a=!0)},function(){o()});if(e&&e.then)return e.then(function(){})}()}catch(e){return n(e)}return i&&i.then?i.then(void 0,n):i}(0,function(e){u=!0,i=e})},function(e,n){function r(t){if(e)throw n;return n}var o=re(function(){var e=function(){if(!a&&null!=t.return)return Promise.resolve(t.return()).then(function(){})}();if(e&&e.then)return e.then(function(){})},function(e,t){if(u)throw i;if(e)throw t;return t});return o&&o.then?o.then(r):r()}))}catch(e){return Promise.reject(e)}var s,l},loaded:function(){try{return Promise.resolve(oe.loader(oe.deps)).then(function(){customElements.define("de-compose",function(e){function t(){return e.apply(this,arguments)||this}return i(t,e),t}(l(HTMLElement))),new MutationObserver(function(e){document.body.dispatchEvent(new Event("attached"))}).observe(document.body,{childList:!0,attributes:!1,subtree:!0}),oe.main(oe),console.log(Z),oe.loaded=!0})}catch(e){return Promise.reject(e)}},detachedCallback:function(e){var t=function(t){e(t)};return t.id=Symbol(),t},state:Z,main:void 0};Object.seal(oe),window.addEventListener("DOMContentLoaded",oe.loaded),exports.de=oe;
