!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e||self).decompose={})}(this,function(e){var t=Symbol(),n=Symbol(),r=Symbol(),o=Symbol(),i=Symbol(),c=Symbol(),u=Symbol(),s=Symbol(),a=function(e,t){console.log("TERROR-801::Attempted to use Object.defineProperty on "+e+", please use the default setter ('"+e+"."+t+" = ') instead")},l=function(e){console.log("TERROR-821::"+e+" is not a valid callback!")};function f(e,t){void 0===t&&(t=!1);var n=f.$||(f.$={enumerable:t,writable:!1,configurable:!1,value:e});return n.value!==e&&(n.value=e),n}var p=function(){function e(e){return this[n]={},this[t]=e,Object.seal(this),this}var c=e.prototype;return c[r]=function(){var e=this;Object.getOwnPropertySymbols(this[n]).forEach(function(r){return e[n][r](e[t])})},c[o]=function(e){this[n][e.id]=e},c[i]=function(e){delete this[n][e.id]},c.valueOf=function(){return this[t]},c.toString=function(){return this[t]},c.toLocaleString=function(){return this[t]},e}(),b=function(){function e(e){var n=this;this.value=e[t];var r=function(e){return!!e.id||(l(e),!1)};return Object.defineProperty(this,"addObserver",f(function(t){return r(t)&&e[o](t),n},!0)),Object.defineProperty(this,"deleteObserver",f(function(t){return r(t)&&e[i](t),n},!0)),this}var n=e.prototype;return n.valueOf=function(){return this.value},n.toLocaleString=function(){return this.value},n.toString=function(){return this.value},e}(),h={callbacks:{defineProperty:function(e,t){return a("this.callbacks",t),!0},get:function(e,t){return e[t]},set:function(e,t,n){return n.id=Symbol(),Object.defineProperty(e,t,f(n,!0)),!0}},observables:{defineProperty:function(e,t){return a("this.observables",t),!0},get:function(e,t){return new b(e[t])},set:function(e,n,o){return e[n]?e[n][t]=o:e[n]=new p(o),e[n][r](),!0}},components:{defineProperty:function(){l("componentsRegistry")},get:function(e,t){return e[t]},set:function(){return!0}}};function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function v(e,t,n){return t&&m(e.prototype,t),n&&m(e,n),e}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function O(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function g(e,t,n){return(g=O()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&y(o,n.prototype),o}).apply(null,arguments)}function j(e){var t="function"==typeof Map?new Map:void 0;return(j=function(e){if(null===e||-1===Function.toString.call(e).indexOf("[native code]"))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return g(e,arguments,d(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),y(n,e)})(e)}var P=regeneratorRuntime.mark(k);function k(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=0;case 1:return t.next=3,"GID"+e+Date.now()+e;case 3:e+=1;case 4:t.next=1;break;case 6:case"end":return t.stop()}},P)}var w=k(),S={val:"",get:function(){return this.val=w.next().value,this.val}},E=function(){function e(e,t){var n=this;this[c]=Object.create(null),this[u]=Object.create(null),this.callbacks=new Proxy(this[c],h.callbacks),this.observables=new Proxy(this[u],h.observables),this.properties={components:{}};var r=0;return t.forEach(function(o,i){var c,u;switch(typeof o){case"string":c=[].concat(e[i].matchAll(/<$/g)),u=[].concat(e[i+1].matchAll(/^>/g)),c[0]&&u[0]?(S.get(),n.properties[o]='gid value="'+S.val+'"></gid',n.properties.components[o]='gid[value="'+S.val+'"]'):n.properties[o]="";break;case"function":n.properties["cProp"+r]=o();break;case"object":n.properties["cProp"+r]=o.$;break;default:n.properties["cProp"+r]=o,t[i]="cProp"+r,r+=1}}),console.log(this.properties),this[s]=function(e,t){return function(n){var r=e[0];return console.log(t),t.forEach(function(t,o){r+=n[t]?n[t]:"",r+=e[o+1]}),(new DOMParser).parseFromString(r,"text/html").body.firstChild}}(e,t),this.elements=[],function(e){var t=[].concat(e.matchAll(/jayes-name=([a-zA-Z_$][a-zA-Z_$0-9]+)/g)),n=[];return t.forEach(function(e){n.push(e[1])}),n}(e.join(".")).forEach(function(e){return n.elements.push(e)}),this}var t=e.prototype;return t.setName=function(e){return this.Name=e,customElements.define("d-"+this.Name,function(e){var t,n;function r(){return e.apply(this,arguments)||this}return n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,y(t,n),r}(j(HTMLElement))),this.element=document.createElement("d-"+this.Name),this},t.setOnLoad=function(e){return this.onLoad=e,this},v(e,[{key:"name",get:function(){return this.Name}}]),e}();function x(e){var t=new E(e.lines,e.keys).setName(e.name);return e.onLoad&&t.setOnLoad(e.onLoad),e.callbacks&&Object.entries(e.callbacks).forEach(function(e){t.callbacks[e[0]]=e[1]}),e.observables&&Object.entries(e.observables).forEach(function(e){t.observables[e[0]]=e[1]}),function(){function e(e){var n=this;this.properties={};var r={};Object.assign(this.properties,t.properties),e&&e.components?(Object.assign(r,e.components),delete e.components):Object.assign(r,t.properties.components),e&&Object.entries(e).forEach(function(e){var t=e[1];t&&(n.properties[e[0]]=t)}),this.element=document.createElement("d-"+t.name),this.element.appendChild(t[s](this.properties)),Object.entries(r).forEach(function(e){var t=e[1],r=n.element.querySelector(n.properties.components[e[0]]);r&&(t&&"object"==typeof t&&(r.insertAdjacentElement("afterend",t.element),t.onLoad&&t.onLoad()),r.remove())}),this.elements={},t.elements.forEach(function(e){n.elements[e]=n.element.querySelector('[jayes-name="'+e+'"]')}),this.callbacks=new Proxy(Object.create(null),h.callbacks),Object.entries(t[c]).forEach(function(e){var t=e[0],r=e[1].bind(n);n.callbacks[t]=r}),this.observables=new Proxy(Object.create(null),h.observables),Object.entries(t[u]).forEach(function(e){n.observables[e[0]]=e[1]});var o=t.onLoad;return o&&(this.onLoad=o.bind(this)),this}var n=e.prototype;return n.toString=function(){return this.element.outerHTML},n.toLocaleString=function(){return this.element.outerHTML},n.valueOf=function(){return this.element},v(e,[{key:"name",get:function(){return t.name}}]),e}()}var L=Object.create(null),R=new Proxy(L,h.components);e.de={components:R,compose:function(e){var t=arguments;return function(n){return n.lines=e,n.keys=[].slice.call(t,1),L[n.name]=x(n),R}}}});
