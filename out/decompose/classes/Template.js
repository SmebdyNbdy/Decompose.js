import{APPLY_PROPS,RAWC,RAWO}from"../consts/symbols.js";import{PROXY}from"../consts/proxy.js";import{findJsVars,templateToFunc}from"../funcs.js";import{gid}from"../globs.js";import{Style}from"./Style.js";export var style=new Style;style.insert("de-group {\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    justify-content: space-evenly;\n    align-content: space-evenly;\n    &[col] {\n        flex-direction: column;\n        justify-content: stretch;\n    }\n    &[stretch] {\n        align-items: stretch;\n    }\n    &[wrap] {\n        flex-wrap: wrap;\n        justify-content: space-evenly;\n    }\n}");export class Template{constructor(e,t){this[RAWC]=Object.create(null),this[RAWO]=Object.create(null),this.callbacks=new Proxy(this[RAWC],PROXY.callbacks),this.observables=new Proxy(this[RAWO],PROXY.observables),this.properties={components:{}};let s=0;t.forEach(((n,r)=>{let o,i;switch(typeof n){case"string":o=[...e[r].matchAll(/<$/g)],i=[...e[r+1].matchAll(/^>/g)],o[0]&&i[0]?(gid.get(),this.properties[n]=`gid value="${gid.val}"></gid`,this.properties.components[n]=`gid[value="${gid.val}"]`):this.properties[n]="";break;case"function":this.properties[`cProp${s}`]=n();break;case"object":this.properties[`cProp${s}`]=n.$;break;default:this.properties[`cProp${s}`]=n,t[r]=`cProp${s}`,s+=1}})),console.log(this.properties),this.elements=[];let n=findJsVars(e);return n.names.forEach((e=>this.elements.push(e))),this[APPLY_PROPS]=templateToFunc(n.lines,t),console.log(n),this}get name(){return this.Name}setStyle(e){style.insertScoped(`de-${this.Name}`,e)}setName(e){return this.Name=e,customElements.define(`de-${this.Name}`,class extends HTMLElement{constructor(){super(),style.insert(`${this.tagName.toLowerCase()} {\n                        display: contents;\n                    }`)}}),this.element=document.createElement(`de-${this.Name}`),this}setOnLoad(e){return this.onLoad=e,this}}