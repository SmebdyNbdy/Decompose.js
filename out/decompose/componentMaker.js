import{APPLY_PROPS,RAWC,RAWO}from"./consts/symbols.js";import{PROXY}from"./consts/proxy.js";import{Template}from"./classes/Template.js";export function componentMaker(e){let t=new Template(e.lines,e.keys).setName(e.name);e.onLoad&&t.setOnLoad(e.onLoad),e.callbacks&&Object.entries(e.callbacks).forEach((([e,s])=>{t.callbacks[e]=s})),e.observables&&Object.entries(e.observables).forEach((([e,s])=>{t.observables[e]=s}));return class{constructor(e){this.properties={},Object.assign(this.properties,t.properties),Object.entries(e).forEach((([e,t])=>{t&&(this.properties[e]=t)})),console.log(t.properties),console.log(this.properties),this.element=document.createElement(`d-${t.name}`),this.element.innerHTML=t[APPLY_PROPS](this.properties),this.elements={},t.elements.forEach((e=>{this.elements[e]=this.element.querySelector(`[jayes-name="${e}"]`)})),this.callbacks=new Proxy(Object.create(null),PROXY.callbacks),Object.entries(t[RAWC]).forEach((([e,t])=>{let s=t.bind(this);this.callbacks[e]=s})),this.observables=new Proxy(Object.create(null),PROXY.observables),Object.entries(t[RAWO]).forEach((([e,t])=>{this.observables[e]=t}));let s=t.onLoad;return s&&(this.onLoad=s.bind(this)),this}get name(){return t.name}get asProp(){let e=this.element.outerHTML;return e=e.replaceAll(/^</g,"").replaceAll(/>$/g,""),e}toString(){return this.asProp}toLocaleString(){return this.asProp}valueOf(){return this.asProp}}}