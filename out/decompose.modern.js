const e=Symbol(),t=Symbol(),s=Symbol(),r=Symbol(),n=Symbol(),o=Symbol(),i=Symbol(),l=Symbol(),a={e801(e,t){console.log(`TERROR-801::Attempted to use Object.defineProperty on ${e}, please use the default setter ('${e}.${t} = ') instead`)},e821(e){console.log(`TERROR-821::${e} is not a valid callback!`)}};function c(e,t=!1){var s=c.$||(c.$={enumerable:t,writable:!1,configurable:!1,value:e});return s.value!==e&&(s.value=e),s}class h{constructor(s){return this[t]={},this[e]=s,Object.seal(this),this}[s](){Object.getOwnPropertySymbols(this[t]).forEach(s=>this[t][s](this[e]))}[r](e){this[t][e.id]=e}[n](e){delete this[t][e.id]}valueOf(){return this[e]}toString(){return this[e]}toLocaleString(){return this[e]}}class b{constructor(t){this.value=t[e];let s=e=>!!e.id||(a.e821(e),!1);return Object.defineProperty(this,"addObserver",c(e=>(s(e)&&t[r](e),this),!0)),Object.defineProperty(this,"deleteObserver",c(e=>(s(e)&&t[n](e),this),!0)),this}valueOf(){return this.value}toLocaleString(){return this.value}toString(){return this.value}}const u={callbacks:{defineProperty:(e,t)=>(a.e801("this.callbacks",t),!0),get:(e,t)=>e[t],set:(e,t,s)=>(s.id=Symbol(),Object.defineProperty(e,t,c(s,!0)),!0)},observables:{defineProperty:(e,t)=>(a.e801("this.observables",t),!0),get:(e,t)=>new b(e[t]),set:(t,r,n)=>(t[r]?t[r][e]=n:t[r]=new h(n),t[r][s](),!0)},components:{defineProperty(){a.e821("componentsRegistry")},get:(e,t)=>e[t],set:()=>!0}},m=function*(){let e=0;for(;;)yield`GID${e}${Date.now()}${e}`,e+=1}();var p={val:"",get(){return this.val=m.next().value,this.val}};class d{constructor(e,t){this[o]=Object.create(null),this[i]=Object.create(null),this.callbacks=new Proxy(this[o],u.callbacks),this.observables=new Proxy(this[i],u.observables),this.properties={components:{}};let s=0;return t.forEach((r,n)=>{let o,i;switch(typeof r){case"string":o=[...e[n].matchAll(/<$/g)],i=[...e[n+1].matchAll(/^>/g)],o[0]&&i[0]?(p.get(),this.properties[r]=`gid value="${p.val}"></gid`,this.properties.components[r]=`gid[value="${p.val}"]`):this.properties[r]="";break;case"function":this.properties[`cProp${s}`]=r();break;case"object":this.properties[`cProp${s}`]=r.$;break;default:this.properties[`cProp${s}`]=r,t[n]=`cProp${s}`,s+=1}}),console.log(this.properties),this[l]=function(e,t){return s=>{let r=e[0];return console.log(t),t.forEach((t,n)=>{r+=s[t]?s[t]:"",r+=e[n+1]}),(new DOMParser).parseFromString(r,"text/html").body.firstChild}}(e,t),this.elements=[],function(e){let t=[...e.matchAll(/jayes-name=([a-zA-Z_$][a-zA-Z_$0-9]+)/g)],s=[];return t.forEach(e=>{s.push(e[1])}),s}(e.join(".")).forEach(e=>this.elements.push(e)),this}get name(){return this.Name}setName(e){return this.Name=e,customElements.define(`d-${this.Name}`,class extends HTMLElement{}),this.element=document.createElement(`d-${this.Name}`),this}setOnLoad(e){return this.onLoad=e,this}}let f=Object.create(null);var v=new Proxy(f,u.components);let y={components:v,compose:function(e,...t){return s=>(s.lines=e,s.keys=t,f[s.name]=function(e){let t=new d(e.lines,e.keys).setName(e.name);return e.onLoad&&t.setOnLoad(e.onLoad),e.callbacks&&Object.entries(e.callbacks).forEach(([e,s])=>{t.callbacks[e]=s}),e.observables&&Object.entries(e.observables).forEach(([e,s])=>{t.observables[e]=s}),class{constructor(e){this.properties={};let s={};Object.assign(this.properties,t.properties),e&&e.components?(Object.assign(s,e.components),delete e.components):Object.assign(s,t.properties.components),e&&Object.entries(e).forEach(([e,t])=>{t&&(this.properties[e]=t)}),this.element=document.createElement(`d-${t.name}`),this.element.appendChild(t[l](this.properties)),Object.entries(s).forEach(([e,t])=>{let s=this.element.querySelector(this.properties.components[e]);s&&(t&&"object"==typeof t&&(s.insertAdjacentElement("afterend",t.element),t.onLoad&&t.onLoad()),s.remove())}),this.elements={},t.elements.forEach(e=>{this.elements[e]=this.element.querySelector(`[jayes-name="${e}"]`)}),this.callbacks=new Proxy(Object.create(null),u.callbacks),Object.entries(t[o]).forEach(([e,t])=>{let s=t.bind(this);this.callbacks[e]=s}),this.observables=new Proxy(Object.create(null),u.observables),Object.entries(t[i]).forEach(([e,t])=>{this.observables[e]=t});let r=t.onLoad;return r&&(this.onLoad=r.bind(this)),this}get name(){return t.name}toString(){return this.element.outerHTML}toLocaleString(){return this.element.outerHTML}valueOf(){return this.element}}}(s),v)}};export{y as de};
